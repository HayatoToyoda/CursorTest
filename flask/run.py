#!/usr/bin/env python3
"""
Flask Application Runner
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ä½¿ç”¨æ–¹æ³•:
    python run.py                # é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ
    python run.py --debug        # ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ
    python run.py --port 8000    # ã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ãƒˆã§å®Ÿè¡Œ
"""

import argparse
import os
import sys
from pathlib import Path

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’Pythonãƒ‘ã‚¹ã«è¿½åŠ 
project_root = Path(__file__).parent
sys.path.insert(0, str(project_root))

try:
    from app import app
except ImportError as e:
    print(f"ã‚¨ãƒ©ãƒ¼: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: {e}")
    print("å¿…è¦ãªä¾å­˜é–¢ä¿‚ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„:")
    print("pip install -r requirements.txt")
    sys.exit(1)

def main():
    parser = argparse.ArgumentParser(description='Flask Application Runner')
    parser.add_argument('--debug', action='store_true', 
                       help='ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ')
    parser.add_argument('--port', type=int, default=5000,
                       help='ãƒãƒ¼ãƒˆç•ªå· (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5000)')
    parser.add_argument('--host', default='0.0.0.0',
                       help='ãƒ›ã‚¹ãƒˆ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 0.0.0.0)')
    
    args = parser.parse_args()
    
    # ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
    if args.debug:
        os.environ['FLASK_DEBUG'] = 'True'
    
    os.environ['PORT'] = str(args.port)
    
    print("=" * 50)
    print("ğŸš€ Flask Application Starting...")
    print("=" * 50)
    print(f"ğŸ“ Host: {args.host}")
    print(f"ğŸ”Œ Port: {args.port}")
    print(f"ğŸ› Debug: {'Enabled' if args.debug else 'Disabled'}")
    print(f"ğŸŒ URL: http://localhost:{args.port}")
    print("=" * 50)
    print("çµ‚äº†ã™ã‚‹ã«ã¯ Ctrl+C ã‚’æŠ¼ã—ã¦ãã ã•ã„")
    print("=" * 50)
    
    try:
        app.run(
            host=args.host,
            port=args.port,
            debug=args.debug
        )
    except KeyboardInterrupt:
        print("\nğŸ‘‹ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«çµ‚äº†ã—ã¾ã—ãŸã€‚")
    except Exception as e:
        print(f"\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        sys.exit(1)

if __name__ == '__main__':
    main()